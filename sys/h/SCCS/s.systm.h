h39411
s 00002/00001/00079
d D 7.6 88/05/26 09:02:36 karels 50 49
c lint
e
s 00000/00001/00080
d D 7.5 87/06/06 15:11:13 mckusick 49 48
c calloc is gone
e
s 00002/00007/00079
d D 7.4 87/01/08 12:08:30 bostic 48 47
c comment fix
e
s 00001/00000/00085
d D 7.3 86/11/25 16:40:55 sam 47 46
c kdb additions
e
s 00001/00001/00084
d D 7.2 86/10/13 23:02:24 karels 46 45
c merge in tahoe system
e
s 00001/00001/00084
d D 7.1 86/06/04 23:28:50 mckusick 45 44
c 4.3BSD release version
e
s 00000/00003/00085
d D 6.5 86/02/23 23:01:03 karels 44 43
c lint
e
s 00000/00002/00088
d D 6.4 86/01/05 18:28:59 mckusick 43 42
c get rid of unused queue() and dequeue() (from sun!shannon)
e
s 00007/00001/00083
d D 6.3 85/06/08 15:09:04 mckusick 42 41
c Add copyright
e
s 00000/00001/00084
d D 6.2 85/03/01 17:57:16 karels 41 40
c hand not global now
e
s 00000/00000/00085
d D 6.1 83/07/29 06:14:12 sam 40 39
c 4.2 distribution
e
s 00000/00004/00085
d D 4.35 83/05/22 17:22:22 sam 39 38
c purge mush; make quota's permanent
e
s 00000/00001/00089
d D 4.34 83/03/31 18:16:57 sam 38 37
c getmdev no more dev_t
e
s 00000/00001/00090
d D 4.33 83/02/10 16:09:29 sam 37 36
c hz already defined in kernel.h
e
s 00003/00002/00088
d D 4.32 82/11/15 12:30:12 sam 36 35
c extern's added for fsck
e
s 00002/00002/00088
d D 4.31 82/10/31 16:36:13 root 35 34
c drop umbabeg,end and catcher
e
s 00002/00000/00088
d D 4.30 82/10/20 01:57:09 root 34 33
c lint
e
s 00000/00003/00088
d D 4.29 82/10/20 01:16:27 root 33 32
c lint
e
s 00000/00000/00091
d D 4.28 82/09/08 08:11:50 root 32 31
c label_t now a structure; other misc changes
e
s 00000/00001/00091
d D 4.27 82/09/06 23:01:25 root 31 30
c more timer stuff
e
s 00000/00003/00092
d D 4.26 82/09/04 09:29:20 root 30 29
c being breakup into kernel.h sanely
e
s 00002/00000/00093
d D 4.25 82/07/16 17:05:18 kre 29 28
c added defn of mcode (&szmcode) - /etc/mush startup code
e
s 00001/00003/00092
d D 4.24 82/06/14 22:54:38 root 28 27
c declare wmemall
e
s 00001/00000/00094
d D 4.23 82/06/07 22:07:51 mckusick 27 26
c calculate size for read ahead block
e
s 00002/00000/00092
d D 4.22 81/11/26 11:54:24 wnj 26 25
c before carry to arpavax
e
s 00002/00000/00090
d D 4.21 81/11/20 14:28:00 wnj 25 24
c more lint
e
s 00000/00001/00090
d D 4.20 81/11/18 15:47:09 wnj 24 23
c more cleanup
e
s 00005/00001/00086
d D 4.19 81/11/16 14:24:55 wnj 23 22
c more lint
e
s 00001/00000/00086
d D 4.18 81/10/17 16:14:35 wnj 22 21
c cleanup (mpx removal, old tty removal, beginnings of select)
e
s 00001/00000/00085
d D 4.17 81/05/05 21:54:44 wnj 21 20
c add global boothowto, the reboot flags from console subsystem
e
s 00001/00000/00084
d D 4.16 81/04/28 03:02:09 root 20 19
c char *wmemall
e
s 00001/00000/00083
d D 4.15 81/04/18 11:33:36 wnj 19 18
c add variable for communications between swap and wakeup
e
s 00000/00003/00083
d D 4.14 81/03/09 00:27:27 wnj 18 17
c lint
e
s 00001/00000/00085
d D 4.13 81/02/28 18:01:33 wnj 17 16
c fixups for rm* routines
e
s 00003/00000/00082
d D 4.12 81/02/27 00:03:43 wnj 16 15
c add hz, timezone and dstflag
e
s 00001/00001/00081
d D 4.11 81/02/19 21:42:17 wnj 15 14
c %G%->%E%
e
s 00001/00000/00081
d D 4.10 81/02/19 21:30:33 wnj 14 13
c added catcher
e
s 00001/00001/00080
d D 4.9 81/02/19 11:52:02 wnj 13 12
c dont specify size of intstack
e
s 00000/00002/00081
d D 4.8 81/02/15 12:14:17 wnj 12 11
c bootable autoconf version
e
s 00001/00001/00082
d D 4.7 81/02/08 18:38:35 wnj 11 10
c cpusid->cpu
e
s 00001/00002/00082
d D 4.6 81/02/08 01:30:01 wnj 10 9
c misc
e
s 00001/00000/00083
d D 4.5 81/02/07 15:55:07 wnj 9 8
c 
e
s 00003/00001/00080
d D 4.4 81/02/04 01:34:40 wnj 8 7
c added dumpdev dumplo
e
s 00001/00001/00080
d D 4.3 81/01/26 22:32:05 kre 7 6
c added defn of 'schar()' as external fn
e
s 00000/00001/00081
d D 4.2 81/01/15 19:40:09 wnj 6 5
c remove msgbuf declaration
e
s 00000/00000/00082
d D 4.1 80/11/09 17:01:44 bill 5 4
c stamp for 4bsd
e
s 00002/00010/00080
d D 3.4 80/07/01 08:17:09 bill 4 3
c various minor fixups pre-split to dev dir
e
s 00001/00001/00089
d D 3.3 80/06/07 03:00:54 bill 3 2
c %H%->%G%
e
s 00001/00001/00089
d D 3.2 80/05/03 17:20:22 bill 2 1
c speeling error
e
s 00090/00000/00000
d D 3.1 80/04/09 16:25:25 bill 1 0
c date and time created 80/04/09 16:25:25 by bill
e
u
U
t
T
I 1
D 3
/*	%M%	%I%	%H%	*/
E 3
I 3
D 15
/*	%M%	%I%	%G%	*/
E 15
I 15
D 42
/*	%M%	%I%	%E%	*/
E 42
I 42
/*
D 45
 * Copyright (c) 1982 Regents of the University of California.
E 45
I 45
 * Copyright (c) 1982, 1986 Regents of the University of California.
E 45
 * All rights reserved.  The Berkeley software License Agreement
 * specifies the terms and conditions for redistribution.
 *
 *	%W% (Berkeley) %G%
 */
E 42
E 15
E 3

/*
 * Random set of variables
 * used by more than one
 * routine.
 */
I 16
D 37
int	hz;			/* frequency of the clock */
E 37
D 33
int	timezone;		/* minutes west from greenwich */
int	dstflag;		/* daylight savings time in effect? */
E 33
E 16
D 24
char	canonb[CANBSIZ];	/* buffer for erase and kill (#@) */
E 24
D 11
int	cpusid;			/* cpu SID register */
E 11
I 11
D 12
int	cpu;			/* cpu SID register */
E 12
E 11
D 36
char	version[];		/* system version */
E 36
D 31
int	lbolt;			/* time of day in 60th not in time */
E 31
D 30
time_t	time;			/* time in sec from 1970 */
time_t	bootime;		/* time at which booted */

E 30
D 41
int	hand;			/* current index into coremap used by daemon */
E 41
I 36
extern	char version[];		/* system version */
E 36

/*
D 48
 * Nblkdev is the number of entries
 * (rows) in the block switch. It is
 * set in binit/bio.c by making
 * a pass over the switch.
 * Used in bounds checking on major
 * device numbers.
E 48
I 48
 * Nblkdev is the number of entries (rows) in the block switch.
 * Used in bounds checking on major device numbers.
E 48
 */
int	nblkdev;

/*
 * Number of character switch entries.
D 2
 * Set by cinit/tty.c
E 2
I 2
D 48
 * Set by cinit/prim.c
E 48
E 2
 */
int	nchrdev;

I 4
int	nswdev;			/* number of swap devices */
E 4
int	mpid;			/* generic for unique process id's */
char	runin;			/* scheduling flag */
char	runout;			/* scheduling flag */
int	runrun;			/* scheduling flag */
char	kmapwnt;		/* kernel map want flag */
char	curpri;			/* more scheduling */

int	maxmem;			/* actual max memory per process */
int	physmem;		/* physical memory on this CPU */

D 4
daddr_t	swplo;			/* block number of swap space */
E 4
int	nswap;			/* size of swap space */
int	updlock;		/* lock for sync */
daddr_t	rablock;		/* block to be read ahead */
I 27
int	rasize;			/* size of block in rablock */
E 27
D 6
char	msgbuf[MSGBUFS];	/* saved "printf" characters */
E 6
D 13
int	intstack[512];		/* stack for interrupts */
E 13
I 13
extern	int intstack[];		/* stack for interrupts */
E 13
dev_t	rootdev;		/* device of the root */
I 8
dev_t	dumpdev;		/* device to take dumps on */
long	dumplo;			/* offset into dumpdev */
E 8
dev_t	swapdev;		/* swapping device */
I 4
D 8
dev_t	argdev;
E 8
I 8
dev_t	argdev;			/* device for argument lists */
E 8
E 4
D 33
dev_t	pipedev;		/* pipe device */
E 33

I 35
D 46
#ifdef vax
E 46
I 46
#if defined(vax) || defined(tahoe)
E 46
E 35
extern	int icode[];		/* user init code */
extern	int szicode;		/* its size */
I 35
#endif
E 35
I 34
D 39
#ifdef MUSH
E 34
I 29
extern	int mcode[];		/* MUSH: startup code */
extern	int szmcode;		/* & its size */
I 34
#endif
E 39
E 34
E 29

D 18
extern	int printsw;		/* debug print switch */
extern	int coresw;		/* switch to force action on core dumps */

E 18
D 38
dev_t	getmdev();
E 38
daddr_t	bmap();
I 9
D 49
caddr_t	calloc();
E 49
E 9
D 44
unsigned max();
unsigned min();
E 44
int	memall();
D 7
int	uchar();
E 7
I 7
D 44
int	uchar(), schar();
E 44
E 7
int	vmemall();
I 25
D 28
#if 0
E 25
I 20
char	*wmemall();
I 25
#endif
E 28
I 28
D 50
caddr_t	wmemall();
E 50
E 28
E 25
E 20
swblk_t	vtod();
D 4
/*
 * Instrumentation
 */
int	dk_busy;
long	dk_time[32];
long	dk_numb[3];
long	dk_wds[3];
long	tk_nin;
long	tk_nout;
E 4

/*
 * Structure of the system-entry table
 */
extern struct sysent
{
D 10
	char	sy_narg;		/* total number of arguments */
	char	sy_nrarg;		/* number of args in registers */
E 10
I 10
	int	sy_narg;		/* total number of arguments */
E 10
	int	(*sy_call)();		/* handler */
} sysent[];

D 36
char	vmmap[];		/* poor name! */
E 36
D 12
int	mcr[3];			/* memory controller registers */
E 12
D 35
int	umbabeg,umbaend;	/* where sensitive vm begins/ends */
E 35
int	noproc;			/* no one is running just now */
I 14
D 35
extern	int catcher[256];
E 35
I 17
char	*panicstr;
I 19
int	wantin;
I 21
int	boothowto;		/* reboot flags, from console subsystem */
I 50
#ifdef	KADB
E 50
I 47
char	*bootesym;		/* end of symbol info from boot */
I 50
#endif
E 50
E 47
I 22
D 23
int	select();
E 23
I 23
int	selwait;
I 36

extern	char vmmap[];		/* poor name! */
E 36

/* casts to keep lint happy */
#define	insque(q,p)	_insque((caddr_t)q,(caddr_t)p)
#define	remque(q)	_remque((caddr_t)q)
I 26
D 43
#define	queue(q,p)	_queue((caddr_t)q,(caddr_t)p)
#define	dequeue(q)	_dequeue((caddr_t)q)
E 43
E 26
E 23
E 22
E 21
E 19
E 17
E 14
E 1
